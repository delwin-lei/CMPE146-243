   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.syntax unified
  15              		.file	"spi_flash.cpp"
  16              		.section	.text.spi1_exchange_byte,"axG",%progbits,spi1_exchange_byte,comdat
  17              		.align	1
  18              		.weak	spi1_exchange_byte
  19              		.thumb
  20              		.thumb_func
  22              	spi1_exchange_byte:
  23              		@ args = 0, pretend = 0, frame = 0
  24              		@ frame_needed = 0, uses_anonymous_args = 0
  25              		@ link register save eliminated.
  26 0000 044B     		ldr	r3, .L5
  27 0002 9860     		str	r0, [r3, #8]
  28              	.L2:
  29 0004 DA68     		ldr	r2, [r3, #12]
  30 0006 D206     		lsls	r2, r2, #27
  31 0008 FCD4     		bmi	.L2
  32 000a 024B     		ldr	r3, .L5
  33 000c 9868     		ldr	r0, [r3, #8]
  34 000e C0B2     		uxtb	r0, r0
  35 0010 7047     		bx	lr
  36              	.L6:
  37 0012 00BF     		.align	2
  38              	.L5:
  39 0014 00000340 		.word	1073938432
  41              		.text
  42              		.align	1
  43              		.thumb
  44              		.thumb_func
  46              	_ZL15spiExchangeBytec:
  47              		@ args = 0, pretend = 0, frame = 0
  48              		@ frame_needed = 0, uses_anonymous_args = 0
  49 0000 08B5     		push	{r3, lr}
  50 0002 FFF7FEFF 		bl	spi1_exchange_byte
  51 0006 08BD     		pop	{r3, pc}
  53              		.align	1
  54              		.thumb
  55              		.thumb_func
  57              	_ZL16waitUntilNotBusyv:
  58              		@ args = 0, pretend = 0, frame = 0
  59              		@ frame_needed = 0, uses_anonymous_args = 0
  60 0008 10B5     		push	{r4, lr}
  61 000a 074C     		ldr	r4, .L11
  62 000c 4023     		movs	r3, #64
  63 000e E361     		str	r3, [r4, #28]
  64 0010 D720     		movs	r0, #215
  65 0012 FFF7F5FF 		bl	_ZL15spiExchangeBytec
  66              	.L9:
  67 0016 FF20     		movs	r0, #255
  68 0018 FFF7FEFF 		bl	spi1_exchange_byte
  69 001c 0306     		lsls	r3, r0, #24
  70 001e FAD5     		bpl	.L9
  71 0020 4023     		movs	r3, #64
  72 0022 A361     		str	r3, [r4, #24]
  73 0024 10BD     		pop	{r4, pc}
  74              	.L12:
  75 0026 00BF     		.align	2
  76              	.L11:
  77 0028 00C00920 		.word	537509888
  79              		.align	1
  80              		.thumb
  81              		.thumb_func
  83              	_ZL15flash_WritePagePh16FlashAddressType.isra.1:
  84              		@ args = 0, pretend = 0, frame = 0
  85              		@ frame_needed = 0, uses_anonymous_args = 0
  86 002c 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
  87 0030 9946     		mov	r9, r3
  88 0032 9046     		mov	r8, r2
  89 0034 0F46     		mov	r7, r1
  90 0036 0646     		mov	r6, r0
  91 0038 0C4C     		ldr	r4, .L14
  92 003a 4025     		movs	r5, #64
  93 003c FFF7E4FF 		bl	_ZL16waitUntilNotBusyv
  94 0040 E561     		str	r5, [r4, #28]
  95 0042 8220     		movs	r0, #130
  96 0044 FFF7DCFF 		bl	_ZL15spiExchangeBytec
  97 0048 4846     		mov	r0, r9
  98 004a FFF7D9FF 		bl	_ZL15spiExchangeBytec
  99 004e 4046     		mov	r0, r8
 100 0050 FFF7D6FF 		bl	_ZL15spiExchangeBytec
 101 0054 3846     		mov	r0, r7
 102 0056 FFF7D3FF 		bl	_ZL15spiExchangeBytec
 103 005a 0122     		movs	r2, #1
 104 005c 4FF48071 		mov	r1, #256
 105 0060 3046     		mov	r0, r6
 106 0062 FFF7FEFF 		bl	spi1_dma_transfer_block
 107 0066 A561     		str	r5, [r4, #24]
 108 0068 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 109              	.L15:
 110              		.align	2
 111              	.L14:
 112 006c 00C00920 		.word	537509888
 114              		.align	1
 115              		.global	flash_Initialize
 116              		.thumb
 117              		.thumb_func
 119              	flash_Initialize:
 120              		@ args = 0, pretend = 0, frame = 0
 121              		@ frame_needed = 0, uses_anonymous_args = 0
 122 0070 70B5     		push	{r4, r5, r6, lr}
 123 0072 164C     		ldr	r4, .L19
 124 0074 4025     		movs	r5, #64
 125 0076 FFF7C7FF 		bl	_ZL16waitUntilNotBusyv
 126 007a E561     		str	r5, [r4, #28]
 127 007c D720     		movs	r0, #215
 128 007e FFF7BFFF 		bl	_ZL15spiExchangeBytec
 129 0082 FF20     		movs	r0, #255
 130 0084 FFF7FEFF 		bl	spi1_exchange_byte
 131 0088 0646     		mov	r6, r0
 132 008a A561     		str	r5, [r4, #24]
 133 008c 9F20     		movs	r0, #159
 134 008e E561     		str	r5, [r4, #28]
 135 0090 FFF7B6FF 		bl	_ZL15spiExchangeBytec
 136 0094 FF20     		movs	r0, #255
 137 0096 FFF7FEFF 		bl	spi1_exchange_byte
 138 009a F307     		lsls	r3, r6, #31
 139 009c A561     		str	r5, [r4, #24]
 140 009e 11D4     		bmi	.L17
 141 00a0 E561     		str	r5, [r4, #28]
 142 00a2 3D20     		movs	r0, #61
 143 00a4 FFF7ACFF 		bl	_ZL15spiExchangeBytec
 144 00a8 2A20     		movs	r0, #42
 145 00aa FFF7A9FF 		bl	_ZL15spiExchangeBytec
 146 00ae 8020     		movs	r0, #128
 147 00b0 FFF7A6FF 		bl	_ZL15spiExchangeBytec
 148 00b4 A620     		movs	r0, #166
 149 00b6 FFF7A3FF 		bl	_ZL15spiExchangeBytec
 150 00ba A561     		str	r5, [r4, #24]
 151 00bc 0448     		ldr	r0, .L19+4
 152 00be FFF7FEFF 		bl	puts
 153              	.L18:
 154 00c2 FEE7     		b	.L18
 155              	.L17:
 156 00c4 1F38     		subs	r0, r0, #31
 157 00c6 18BF     		it	ne
 158 00c8 0120     		movne	r0, #1
 159 00ca 70BD     		pop	{r4, r5, r6, pc}
 160              	.L20:
 161              		.align	2
 162              	.L19:
 163 00cc 00C00920 		.word	537509888
 164 00d0 00000000 		.word	.LC0
 166              		.align	1
 167              		.global	flash_ReadSector
 168              		.thumb
 169              		.thumb_func
 171              	flash_ReadSector:
 172              		@ args = 0, pretend = 0, frame = 0
 173              		@ frame_needed = 0, uses_anonymous_args = 0
 174 00d4 70B5     		push	{r4, r5, r6, lr}
 175 00d6 4C02     		lsls	r4, r1, #9
 176 00d8 0546     		mov	r5, r0
 177 00da 1646     		mov	r6, r2
 178 00dc FFF794FF 		bl	_ZL16waitUntilNotBusyv
 179 00e0 184B     		ldr	r3, .L26
 180 00e2 4022     		movs	r2, #64
 181 00e4 DA61     		str	r2, [r3, #28]
 182 00e6 184B     		ldr	r3, .L26+4
 183 00e8 C4F30722 		ubfx	r2, r4, #8, #8
 184 00ec C4F30741 		ubfx	r1, r4, #16, #8
 185 00f0 D2B2     		uxtb	r2, r2
 186 00f2 E820     		movs	r0, #232
 187 00f4 9860     		str	r0, [r3, #8]
 188 00f6 E4B2     		uxtb	r4, r4
 189 00f8 9960     		str	r1, [r3, #8]
 190 00fa 9A60     		str	r2, [r3, #8]
 191 00fc FF22     		movs	r2, #255
 192 00fe 9C60     		str	r4, [r3, #8]
 193 0100 9A60     		str	r2, [r3, #8]
 194 0102 9A60     		str	r2, [r3, #8]
 195 0104 9A60     		str	r2, [r3, #8]
 196 0106 9A60     		str	r2, [r3, #8]
 197              	.L22:
 198 0108 DC68     		ldr	r4, [r3, #12]
 199 010a 0F4A     		ldr	r2, .L26+4
 200 010c 14F01004 		ands	r4, r4, #16
 201 0110 FAD1     		bne	.L22
 202 0112 9368     		ldr	r3, [r2, #8]
 203 0114 9368     		ldr	r3, [r2, #8]
 204 0116 9368     		ldr	r3, [r2, #8]
 205 0118 9368     		ldr	r3, [r2, #8]
 206 011a 9368     		ldr	r3, [r2, #8]
 207 011c 9368     		ldr	r3, [r2, #8]
 208 011e 9368     		ldr	r3, [r2, #8]
 209 0120 9368     		ldr	r3, [r2, #8]
 210              	.L24:
 211 0122 B442     		cmp	r4, r6
 212 0124 05EB4420 		add	r0, r5, r4, lsl #9
 213 0128 06DA     		bge	.L23
 214 012a 0022     		movs	r2, #0
 215 012c 4FF40071 		mov	r1, #512
 216 0130 FFF7FEFF 		bl	spi1_dma_transfer_block
 217 0134 0134     		adds	r4, r4, #1
 218 0136 F4E7     		b	.L24
 219              	.L23:
 220 0138 024B     		ldr	r3, .L26
 221 013a 4022     		movs	r2, #64
 222 013c 9A61     		str	r2, [r3, #24]
 223 013e 0020     		movs	r0, #0
 224 0140 70BD     		pop	{r4, r5, r6, pc}
 225              	.L27:
 226 0142 00BF     		.align	2
 227              	.L26:
 228 0144 00C00920 		.word	537509888
 229 0148 00000340 		.word	1073938432
 231              		.align	1
 232              		.global	flash_WriteSector
 233              		.thumb
 234              		.thumb_func
 236              	flash_WriteSector:
 237              		@ args = 0, pretend = 0, frame = 0
 238              		@ frame_needed = 0, uses_anonymous_args = 0
 239 014c 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 240 0150 0546     		mov	r5, r0
 241 0152 9046     		mov	r8, r2
 242 0154 4C02     		lsls	r4, r1, #9
 243 0156 0026     		movs	r6, #0
 244              	.L30:
 245 0158 4645     		cmp	r6, r8
 246 015a 19DA     		bge	.L29
 247 015c 2746     		mov	r7, r4
 248 015e C4F30743 		ubfx	r3, r4, #16, #8
 249 0162 C4F30722 		ubfx	r2, r4, #8, #8
 250 0166 E1B2     		uxtb	r1, r4
 251 0168 2846     		mov	r0, r5
 252 016a 04F58074 		add	r4, r4, #256
 253 016e FFF75DFF 		bl	_ZL15flash_WritePagePh16FlashAddressType.isra.1
 254 0172 C4F30743 		ubfx	r3, r4, #16, #8
 255 0176 C4F30722 		ubfx	r2, r4, #8, #8
 256 017a E1B2     		uxtb	r1, r4
 257 017c 05F58070 		add	r0, r5, #256
 258 0180 FFF754FF 		bl	_ZL15flash_WritePagePh16FlashAddressType.isra.1
 259 0184 05F50075 		add	r5, r5, #512
 260 0188 07F50074 		add	r4, r7, #512
 261 018c 0136     		adds	r6, r6, #1
 262 018e E3E7     		b	.L30
 263              	.L29:
 264 0190 0020     		movs	r0, #0
 265 0192 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 267              		.align	1
 268              		.global	flash_ioctl
 269              		.thumb
 270              		.thumb_func
 272              	flash_ioctl:
 273              		@ args = 0, pretend = 0, frame = 0
 274              		@ frame_needed = 0, uses_anonymous_args = 0
 275 0196 08B5     		push	{r3, lr}
 276 0198 0728     		cmp	r0, #7
 277 019a 05D8     		bhi	.L32
 278 019c DFE800F0 		tbb	[pc, r0]
 279              	.L34:
 280 01a0 06       		.byte	(.L33-.L34)/2
 281 01a1 09       		.byte	(.L35-.L34)/2
 282 01a2 0C       		.byte	(.L36-.L34)/2
 283 01a3 10       		.byte	(.L37-.L34)/2
 284 01a4 12       		.byte	(.L39-.L34)/2
 285 01a5 12       		.byte	(.L39-.L34)/2
 286 01a6 12       		.byte	(.L39-.L34)/2
 287 01a7 12       		.byte	(.L39-.L34)/2
 288              		.p2align 1
 289              	.L32:
 290 01a8 0420     		movs	r0, #4
 291 01aa 08BD     		pop	{r3, pc}
 292              	.L33:
 293 01ac FFF72CFF 		bl	_ZL16waitUntilNotBusyv
 294 01b0 08E0     		b	.L39
 295              	.L35:
 296 01b2 4FF40063 		mov	r3, #2048
 297 01b6 04E0     		b	.L40
 298              	.L36:
 299 01b8 4FF40073 		mov	r3, #512
 300 01bc 0B80     		strh	r3, [r1]	@ movhi
 301 01be 01E0     		b	.L39
 302              	.L37:
 303 01c0 0123     		movs	r3, #1
 304              	.L40:
 305 01c2 0B60     		str	r3, [r1]
 306              	.L39:
 307 01c4 0020     		movs	r0, #0
 308 01c6 08BD     		pop	{r3, pc}
 310              		.section	.rodata.str1.1,"aMS",%progbits,1
 311              	.LC0:
 312 0000 2D2D2D2D 		.ascii	"----> POWER OFF AND POWER ON CPU TO INITIALIZE FLAS"
 312      3E20504F 
 312      57455220 
 312      4F464620 
 312      414E4420 
 313 0033 48204D45 		.ascii	"H MEMORY!!! <-------\000"
 313      4D4F5259 
 313      21212120 
 313      3C2D2D2D 
 313      2D2D2D2D 
 314              		.ident	"GCC: (GNU Tools for ARM Embedded Processors) 5.4.1 20160609 (release) [ARM/embedded-5-bran
DEFINED SYMBOLS
                            *ABS*:00000000 spi_flash.cpp
     /tmp/cc3Lm70w.s:17     .text.spi1_exchange_byte:00000000 $t
     /tmp/cc3Lm70w.s:22     .text.spi1_exchange_byte:00000000 spi1_exchange_byte
     /tmp/cc3Lm70w.s:39     .text.spi1_exchange_byte:00000014 $d
     /tmp/cc3Lm70w.s:42     .text:00000000 $t
     /tmp/cc3Lm70w.s:46     .text:00000000 _ZL15spiExchangeBytec
     /tmp/cc3Lm70w.s:57     .text:00000008 _ZL16waitUntilNotBusyv
     /tmp/cc3Lm70w.s:77     .text:00000028 $d
     /tmp/cc3Lm70w.s:79     .text:0000002c $t
     /tmp/cc3Lm70w.s:83     .text:0000002c _ZL15flash_WritePagePh16FlashAddressType.isra.1
     /tmp/cc3Lm70w.s:112    .text:0000006c $d
     /tmp/cc3Lm70w.s:114    .text:00000070 $t
     /tmp/cc3Lm70w.s:119    .text:00000070 flash_Initialize
     /tmp/cc3Lm70w.s:163    .text:000000cc $d
     /tmp/cc3Lm70w.s:166    .text:000000d4 $t
     /tmp/cc3Lm70w.s:171    .text:000000d4 flash_ReadSector
     /tmp/cc3Lm70w.s:228    .text:00000144 $d
     /tmp/cc3Lm70w.s:231    .text:0000014c $t
     /tmp/cc3Lm70w.s:236    .text:0000014c flash_WriteSector
     /tmp/cc3Lm70w.s:272    .text:00000196 flash_ioctl
     /tmp/cc3Lm70w.s:280    .text:000001a0 $d
     /tmp/cc3Lm70w.s:288    .text:000001a8 $t

UNDEFINED SYMBOLS
spi1_dma_transfer_block
puts
